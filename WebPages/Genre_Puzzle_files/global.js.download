"use strict";(function(J){"use strict";let H=!1,M=!1;const D=[];let j=!1;const P=[],x=[];let A;const i={SessionHasExtension:!1,FollowedApps:new Set,IgnoredApps:new Set,OwnedApps:new Set,FamilySharedApps:new Set,WishedApps:new Set,OwnedPackages:new Set,OnExtensionUserdataLoaded:e=>{if(j){e();return}P.push(e)},EnhanceLazyLoadedApps:e=>{const t=e.querySelectorAll(".app");for(const o of t){const a=+o.dataset.appid;i.FollowedApps.has(a)&&o.classList.add("followed"),i.WishedApps.has(a)&&o.classList.add("wished"),i.OwnedApps.has(a)?o.classList.add("owned"):i.FamilySharedApps.has(a)&&o.classList.add("infamily"),i.IgnoredApps.has(a)&&o.classList.add("ignored")}i.BindHover(e)},EnhanceLazyLoadedPackages:e=>{const t=e.querySelectorAll(".package");for(const o of t){const a=+o.dataset.subid;i.OwnedPackages.has(a)&&o.classList.add("owned")}},BindHover:e=>{},HideHoverIfAny:()=>{},Alert:(e,t=null)=>{const o=document.createElement("toast-notification");return t!==null&&(o.toastTitle=t),o.toastBody=e,document.getElementById("js-notifications")?.append(o),o},Storage:{Get(e){try{return window.localStorage.getItem(e)}catch{return null}},Set(e,t){try{window.localStorage.setItem(e,t)}catch{}},Remove(e){try{window.localStorage.removeItem(e)}catch{}}},LazyLoad(e,t){A||(A=new window.IntersectionObserver(o=>{o.forEach(a=>{a.isIntersecting&&(A.unobserve(a.target),a.target.dispatchEvent(new Event("lazyload")))})},{rootMargin:"200px 0px 200px 0px"})),A.observe(e),e.addEventListener("lazyload",t,{once:!0})},ImageError(e){e.complete&&e.naturalWidth===0?e.src="/static/img/applogo.svg":e.addEventListener("error",function(){this.src="/static/img/applogo.svg"},{once:!0})},RequirePageScreenshotViewer(e,t=!1){if(t===!0){for(let o=0;o<x.length;o++)x[o](e);x.length=0,i.RequirePageScreenshotViewer=o=>o(e)}else x.push(e)},RequireHighstock(e){if(window.Highcharts){R(),e();return}if(D.push(e),H)return;H=!0;const t=document.createElement("script");t.nonce=document.querySelector("script[nonce]").nonce,t.src="/static/js/vendor/highstock.js?v=ec10f3c6a7cfe2a3",t.integrity="sha384-7BDzxqfP4qOlpTs5r1WdXx31tgCi/KEGWM9DRN1YBFwuMXAuruXYk7pqZpEOxnzL",t.async=!0,t.addEventListener("load",function(){R();for(const o of D)o();D.length=0,H=!1}),document.head.appendChild(t)}};try{i.SessionHasExtension=!!window.sessionStorage.getItem("extension_user")}catch{}const z=e=>{const t=new Map,o=new Map,a=r=>{const s=+r.dataset.appid,l=t.get(s);l?l.push(r):t.set(s,[r])},u=r=>{const s=+r.dataset.subid,l=o.get(s);l?l.push(r):o.set(s,[r])},h=typeof $=="function"&&typeof $.fn=="object"&&typeof $.fn.dataTable=="function";if(!h||document.querySelector(".scope-depot")){for(const r of document.querySelectorAll(".app"))a(r);for(const r of document.querySelectorAll(".package"))u(r)}if(h&&$($.fn.dataTable.tables()).each(function(){const r=$(this).DataTable().table();for(const s of Array.from(r.rows(".app").nodes()))a(s);for(const s of Array.from(r.rows(".package").nodes()))u(s)}),e.rgFollowedApps){i.FollowedApps=new Set(e.rgFollowedApps);for(const r of e.rgFollowedApps){const s=t.get(r);if(s)for(const l of s)l.classList.add("followed")}}if(e.rgWishlist){i.WishedApps=new Set(e.rgWishlist);for(const r of e.rgWishlist){const s=t.get(r);if(s)for(const l of s)l.classList.add("wished")}}if(e.rgAppsInCart)for(const r of e.rgAppsInCart){const s=t.get(r);if(s)for(const l of s)l.classList.add("cart")}if(e.rgOwnedApps){i.OwnedApps=new Set(e.rgOwnedApps);for(const r of e.rgOwnedApps){const s=t.get(r);if(s)for(const l of s)l.classList.add("owned")}}if(e.rgFamilySharedApps){i.FamilySharedApps=new Set(e.rgFamilySharedApps);for(const r of e.rgFamilySharedApps){const s=t.get(r);if(s)for(const l of s)l.classList.contains("owned")||l.classList.add("infamily")}}if(e.rgIgnoredApps)for(const r of Object.keys(e.rgIgnoredApps)){const s=+r;i.IgnoredApps.add(s);const l=t.get(s);if(l)for(const v of l)v.classList.add("ignored")}if(e.rgOwnedPackages&&(i.OwnedPackages=new Set(e.rgOwnedPackages)),i.OwnedPackages.add(0),o.size>0){if(e.rgPackagesInCart)for(const r of e.rgPackagesInCart){const s=o.get(r);if(s)for(const l of s)l.classList.add("cart")}if(e.rgOwnedPackages)for(const r of e.rgOwnedPackages){const s=o.get(r);if(s)for(const l of s)l.classList.add("owned")}}j=!0;for(const r of P)r();P.length=0},N=!!document.querySelector(".header-user-avatar"),R=()=>{if(M)return;M=!0,window.Highcharts.wrap(window.Highcharts.seriesTypes.flags.prototype,"translate",function(o){if(o.apply(this,...arguments),!this.options.onSeries)return;const a=this.chart.get(this.options.onSeries);!a||!a.points||!a.currentDataGrouping||this.points.forEach(u=>{const h=a.points.find(s=>s.x>u.x);if(!h)return;const r=a.points[h.index>0?h.index-1:0];u.plotX=r.plotX,u.plotY=r.plotY})});const e=1.25,t=N?["copyChartToClipboard","downloadPNG","downloadCSV","downloadXLS"]:["copyChartToClipboard","downloadPNG","steamdbLogin"];window.Highcharts.setOptions({accessibility:{enabled:!1},lang:{locale:"en-GB"},chart:{animation:!1,zooming:{type:"x",mouseWheel:{enabled:!1}},backgroundColor:"transparent",spacing:[5,0,15,0],style:{fontSize:"16px",fontFamily:"inherit"}},title:{style:{color:"var(--body-color)"}},yAxis:{gridLineColor:"rgba(180, 180, 180, 0.2)",labels:{style:{color:"var(--muted-color)"}}},xAxis:{lineColor:"var(--border-color)",tickColor:"var(--border-color)",crosshair:{width:30,color:"rgba(180, 180, 180, 0.2)"},labels:{style:{color:"var(--body-color)"}}},legend:{itemHoverStyle:{color:"var(--link-color)"},itemHiddenStyle:{color:"var(--border-color)"},itemStyle:{color:"var(--body-color)",fontSize:"16px",fontWeight:"400"}},plotOptions:{series:{animation:!1,dataGrouping:{enabled:!1},states:{hover:{lineWidthPlus:0}}}},credits:{text:"data by SteamDB.info (powered by highcharts.com)",position:{x:0,y:-3},style:{fontSize:"12px",color:"var(--muted-color)"}},exporting:{sourceWidth:1200/e,sourceHeight:600/e,scale:e,local:!0,fallbackToExportServer:!1,buttons:{contextButton:{symbol:"url(/static/img/download.svg)",symbolSize:24,symbolX:26,symbolY:25,x:0,y:5,menuItems:t,theme:{fill:"none",states:{hover:{fill:"var(--border-color-2)"},select:{fill:"var(--border-color)"}}}}},menuItemDefinitions:{steamdbLogin:{text:"Login for CSV export"},copyChartToClipboard:{text:"Copy PNG to clipboard",onclick(){const o=this,a="image/png";function u(){return new Promise(h=>{const r=window.Highcharts.Exporting.svgToDataURL(o.exporting.getSVGForExport(o.exporting.options)),s=new Image;s.crossOrigin="anonymous",s.src=r,s.addEventListener("load",()=>{const l=document.createElement("canvas"),v=l.getContext("2d");l.height=s.height*e,l.width=s.width*e,v.drawImage(s,0,0,l.width,l.height),l.toBlob(F=>{h(F)},a)})})}navigator.clipboard.write([new ClipboardItem({[a]:u()})]).then(()=>{const h=i.Alert("The chart png is now in your clipboard.");setTimeout(()=>{h.close()},3e3)}).catch(h=>{console.error(h),i.Alert(`Failed to copy: ${h}`)})}}},chartOptions:{chart:{backgroundColor:"var(--border-color-2)",spacing:[20,20,10,20],style:{fontFamily:"Inter, sans-serif"}},title:{text:"Data by SteamDB",style:{color:"var(--contrast-color)"}},rangeSelector:{enabled:!1},navigator:{enabled:!1},credits:{enabled:!1}}},navigation:{menuStyle:{borderRadius:"6px",borderColor:"var(--border-color)",background:"var(--tooltip-bg)",boxShadow:"-8px -8px 24px rgba(149, 157, 165, 0.2)"},menuItemStyle:{color:"var(--body-bg-color)",transition:"none",fontSize:"14px"}},rangeSelector:{inputEnabled:!1,labelStyle:{color:"var(--body-color)"},buttonTheme:{width:"auto",height:24,paddingLeft:10,paddingRight:10,fill:"none",r:6,stroke:"var(--border-color)","stroke-width":"1px",style:{color:"var(--link-color)",fontSize:"16px",fontWeight:"bold"},states:{hover:{fill:"var(--border-color)",style:{color:"var(--link-color-hover)"}},select:{fill:"var(--border-color)",style:{color:"var(--body-color)"}},disabled:{"stroke-width":0,style:{color:"var(--border-color)"}}}}},navigator:{handles:{backgroundColor:"var(--border-color-2)",borderColor:"var(--link-color)"},xAxis:{gridLineColor:"var(--border-color)",labels:{style:{color:"var(--muted-color)",opacity:1}}},series:{lineWidth:2},outlineColor:"var(--border-color)"},tooltip:{useHTML:!0,shared:!0,split:!1,shadow:!1,borderWidth:0,borderRadius:6,headerFormat:"{ucfirst point.key} UTC<br/>",backgroundColor:"var(--tooltip-bg)",style:{fontSize:"14px",color:"var(--body-bg-color)"}}})},O=(e,t,o)=>{document.querySelectorAll(e).forEach(a=>{o?a.classList.add(t):a.classList.remove(t)})},y=(e,t,o)=>O(`.app[data-appid="${e}"]`,t,o),E=(e,t,o)=>O(`.package[data-subid="${e}"]`,t,o),G=(e,t,o)=>O(`.bundle[data-bundleid="${e}"]`,t,o),V=e=>{if(!(!e.response||!e.response.success)){if(e.request.appid>0){const t=e.request.appid;switch(e.request.contentScriptQuery){case"StoreWishlistAdd":i.WishedApps.add(t),y(t,"wished",!0);break;case"StoreWishlistRemove":i.WishedApps.delete(t),y(t,"wished",!1);break;case"StoreFollow":i.FollowedApps.add(t),y(t,"followed",!0);break;case"StoreUnfollow":i.FollowedApps.delete(t),y(t,"followed",!1);break;case"StoreIgnore":i.IgnoredApps.add(t),y(t,"ignored",!0);break;case"StoreUnignore":i.IgnoredApps.delete(t),y(t,"ignored",!1);break;case"Watch":y(t,"watched",!0);break;case"Unwatch":y(t,"watched",!1);break}}else if(e.request.subid>0){const t=e.request.subid;switch(e.request.contentScriptQuery){case"StoreAddToCart":E(t,"cart",!0);break;case"StoreAddFreeLicense":E(t,"owned",!0);break;case"Watch":E(t,"watched",!0);break;case"Unwatch":E(t,"watched",!1);break}}else if(e.request.bundleid>0){const t=e.request.bundleid;switch(e.request.contentScriptQuery){case"Watch":G(t,"watched",!0);break;case"Unwatch":G(t,"watched",!1);break}}}};if("BroadcastChannel"in window){let e=null;try{e=new BroadcastChannel("steamdb-extension"),e.addEventListener("message",t=>{t&&t.data&&t.data.type==="steamdb:extension-response"&&V(t.data)})}catch{}window.addEventListener("message",t=>{if(!(!t||!t.data)&&t.origin===window.location.origin)if(t.data.type==="steamdb:extension-loaded"){const{data:o}=t.data;document.readyState!=="loading"?z(o):document.addEventListener("readystatechange",()=>{z(o)},{once:!0})}else if(t.data.type==="steamdb:extension-init"){document.querySelectorAll(".js-extension-tip").forEach(a=>{a.hidden=!0}),"OnExtensionInit"in i&&i.OnExtensionInit(t.data.data);try{window.sessionStorage.setItem("extension_user","1"),i.SessionHasExtension=!0}catch{}}else if(t.data.type==="steamdb:extension-error"){try{if(window.sessionStorage.getItem("extension_error_hidden")&&location.pathname!=="/freepackages/")return}catch{}const o=i.Alert(t.data.error,"Extension error");if(navigator.userAgent.includes(" Firefox/")){const u=document.createElement("a");u.href="https://github.com/SteamDatabase/BrowserExtension/issues/56#issuecomment-2740141287",u.textContent="If you use Firefox containers it is not compatible with it, click to read more.";const h=document.createElement("div");h.classList="toast-body",h.append(u),o.append(h)}const a=document.createElement("a");a.className="btn btn-sm btn-primary",a.href="https://store.steampowered.com/login/",a.textContent="Sign in on the Steam Store",o.append(a),o.addEventListener("toast-close",()=>{try{window.sessionStorage.setItem("extension_error_hidden","1")}catch{}})}else t.data.type==="steamdb:extension-response"&&(e!==null&&e.postMessage(t.data),V(t.data),(!t.data.response||!t.data.response.success)&&!location.pathname.startsWith("/freepackages/")&&(i.Alert(`Something went wrong.
`+(t.data.response&&t.data.response.error||"Unknown error. Are you logged in on the Steam store?"),"Extension error"),console.error(t.data.response)))})}const Z=e=>{const t=[];if(e.forEach((o,a)=>{const u=a.toLowerCase();(u.startsWith("__cf_chl_")||u==="ref"||u==="fbclid"||u.startsWith("utm_"))&&t.push(a)}),t.length>0){for(const o of t)e.delete(o);window.history.replaceState(null,null,Array.from(e).length?`${location.pathname}?${e}`:location.pathname)}},X=document.querySelector(".header"),b=document.querySelector(".header-menu-container"),L=document.querySelector("#js-header-hamburger"),k=e=>{document.querySelector(".body-wrap").inert=e},C=()=>{X.classList.remove("header-search-focus"),k(!1)};L.addEventListener("click",function(){b.hidden=!b.hidden,b.hidden||(C(),b.querySelector(".header-menu").focus(),i.HideHoverIfAny()),k(!b.hidden)}),b.addEventListener("click",function(e){e.target instanceof Element&&e.target.className===b.className&&(b.hidden=!0,k(!1))});const I=document.getElementById("js-header-form"),S=I.querySelector(".field");document.addEventListener("keydown",e=>{if(e.key==="Escape"){if(document.documentElement.classList.contains("js-screenshots-shown"))return;b.hidden?C():(b.hidden=!0,L.focus(),k(!1))}e.ctrlKey||e.metaKey||!(e.target instanceof Element)||["INPUT","TEXTAREA","SELECT","BUTTON"].includes(e.target.tagName)&&e.target!==L||(e.code==="Slash"||e.code==="KeyS"||e.key==="/"||e.key==="s"?(e.preventDefault(),S.focus()):(e.code==="KeyM"||e.key==="m")&&(e.preventDefault(),L.click()))});function ee(){this.src="/static/img/applogo.svg"}if(I){I.addEventListener("submit",function(c){const d=S.value.replace(/^\s+|\s+$/g,"");let n=d.match(/^([0-9]{1,7})$/);if(n!==null){window.location.href=`/app/${n[0]}/${W()}`,c.preventDefault();return}if(n=d.match(/(76561[0-9]{12})/),n!==null){window.location.href=`/calculator/${n[1]}/`,c.preventDefault();return}if(n=d.match(/(?:id|profiles?)\/([\d\w-]+)/),n!==null){window.location.href=`/calculator/?player=${n[1]}`,c.preventDefault();return}n=d.match(/(app|sub|bundle|depot|dlc|patchnotes|build)\/\s*([0-9]{1,8})/),n!==null&&(n[1]==="dlc"?n[1]="app":n[1]==="build"&&(n[1]="patchnotes"),window.location.href=`/${n[1]}/${n[2]}/`,c.preventDefault())},!1);const e=document.getElementById("js-search-suggestions"),t=document.getElementById("js-search-tips"),o=new Map;let a=0,u=0,h=0,r="",s;const l=t.dataset.a,v=`https://${l}-dsn.algolia.net`,F={Accept:"application/json","x-algolia-application-id":l,"x-algolia-api-key":t.dataset.k},W=()=>{if(location.pathname==="/charts/")return"charts/";if(location.pathname.startsWith("/patchnotes/"))return"patchnotes/";const c=location.pathname.match(/\/app\/[0-9]+\/(?<page>\w+)/);return c?`${c.groups.page}/`:""},U=()=>{a=0;const d={hitsPerPage:Math.min(20,Math.floor((document.documentElement.clientHeight-130)/55)),attributesToSnippet:null,attributesToHighlight:["name"],attributesToRetrieve:["type","id","small_capsule"],query:r};s&&s.abort(),s=new AbortController,fetch(`${v}/1/indexes/all_names/query?x-algolia-agent=Algolia%20for%20JavaScript%20(SteamDB)`,{method:"POST",body:JSON.stringify(d),signal:s.signal,headers:F}).then(n=>n.json()).then(n=>{o.set(d.query,n),s=null,K(n)}).catch(console.error)},K=c=>{const d=document.body.dataset.storeAssets;let n=-1,m=e.querySelector(".focus");if(m&&(n=+m.dataset.appid),t.hidden=!0,e.replaceChildren(),i.HideHoverIfAny(),!c.hits){const p=document.createElement("span");c.message?p.textContent=`Algolia error: ${c.message}`:p.textContent="No results found.",e.appendChild(p);return}const te=W();c.hits=c.hits.sort((p,g)=>(g.type==="app"?1:0)-(p.type==="app"?1:0));for(const p of c.hits){const g=document.createElement("a");g.classList.add("app");let w="/static/img/applogo.svg",T=!0,_=p.type;switch(p.type){case"app":{const f=p.id;g.dataset.appid=f.toString(),g.href=`/app/${f}/${te}`,i.OwnedApps.has(f)?g.classList.add("owned"):i.FamilySharedApps.has(f)?g.classList.add("infamily"):i.WishedApps.has(f)?g.classList.add("wished"):i.FollowedApps.has(f)&&g.classList.add("followed"),n===f&&(n=-1,g.classList.add("focus")),p.small_capsule?w=`${d}apps/${f}/${p.small_capsule}/capsule_231x87.jpg`:w=`${d}apps/${f}/capsule_231x87.jpg`;break}case"sub":{const f=p.id;g.href=`/sub/${f}/`,i.OwnedPackages.has(f)&&g.classList.add("owned"),p.small_capsule?w=`${d}subs/${f}/${p.small_capsule}`:w=`${d}subs/${f}/capsule_231x87.jpg`;break}case"bundle":{const f=p.id;g.href=`/bundle/${f}/`,p.small_capsule&&(w=`${d}bundles/${f}/${p.small_capsule}/capsule_231x87.jpg`);break}case"developer":case"publisher":case"franchise":{g.href=`/${p.type}/${p.id}/`,w=`${d}${p.small_capsule}`,T=!1;break}case"tag":{g.href=`/tag/${p.id}/`,T=!1,w=null;break}case"tech":{g.href=`/tech/${p.id}/`,_=p.id.substring(0,p.id.indexOf("/")),T=!1,w=null;break}default:continue}if(w){const f=document.createElement("img");f.addEventListener("error",ee,{once:!0}),f.alt="",f.src=w,g.append(f)}const q=document.createElement("span");if(q.className="search-name",q.innerHTML=p._highlightResult.name.value,g.append(q),p.type!=="app"){const f=document.createElement("span");f.className="muted",f.textContent=`${_[0].toUpperCase()}${_.substring(1)}${T?` ${p.id}`:""}`,g.append(f)}e.appendChild(g)}n>-1&&(m=e.firstElementChild,m&&m.classList.add("focus")),i.BindHover(e)};S.addEventListener("keydown",function(c){if(c.key==="ArrowUp"||c.key==="ArrowDown"){c.preventDefault();const d=e.querySelector(".focus");let n;c.key==="ArrowUp"?(d&&(n=d.previousElementSibling),n||(n=e.lastElementChild)):(d&&(n=d.nextElementSibling),n||(n=e.firstElementChild)),n instanceof Element&&(d&&d.classList.remove("focus"),n.classList.add("focus"))}else if(c.key==="Enter"){if(c.ctrlKey){const n=new URLSearchParams;n.append("query",r),window.location.href=`/instantsearch/?${n.toString()}`,c.preventDefault();return}const d=e.querySelector(".focus");if(d)d.click(),c.preventDefault();else{const n=W();if(n.length>0){const m=document.createElement("input");m.type="hidden",m.name="app_tab",m.value=n.substring(0,n.length-1),I.append(m)}}}else c.key==="Escape"&&S.blur()}),S.addEventListener("input",function(){const c=this.value;if(!c||c.length>200){e.replaceChildren(),clearTimeout(a),a=0,s&&s.abort(),r="",t.hidden=!1,i.HideHoverIfAny();return}if(r===c)return;r=c;const d=o.get(r);if(d){clearTimeout(a),a=0,K(d);return}const n=Date.now(),m=N?200:300;if(a){n-h>=600?(clearTimeout(a),U()):n-u<m&&(clearTimeout(a),u=n,a=setTimeout(U,m));return}u=n,h=n,a=setTimeout(U,m)}),document.querySelector(".header-search-close").addEventListener("click",C),document.querySelector(".header-search-side-close").addEventListener("click",C);let Y=!1;const Q=()=>{if(!Y){Y=!0;const c=document.createElement("link");c.rel="preconnect",c.href=v,document.head.append(c);const d=document.querySelectorAll(".header-search-popular img"),n=document.body.dataset.storeAssets;d.forEach(m=>{m.src=`${n}apps/${m.dataset.c}`,i.ImageError(m)})}X.classList.add("header-search-focus"),b.hidden=!0,k(!0),i.HideHoverIfAny()};let B=!1;document.querySelector(".header-search-mobile").addEventListener("click",c=>{c.preventDefault(),Q(),B=!0,S.focus()}),S.addEventListener("focus",()=>{if(B){B=!1;return}window.requestAnimationFrame(Q)})}if(window.location.hostname==="steamdb.info"){const e=new URLSearchParams(location.search);Z(e)}"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).catch(e=>{console.error(e)}),J.SteamDB=i})(typeof exports<"u"?exports:window);
